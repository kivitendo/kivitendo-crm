<!DOCTYPE html>
<html>
  
<head>
<meta charset='utf-8' />
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
<?php
    require_once __DIR__.'/inc/stdLib.php';
    //echo $head['BOOTSTRAP_CSS'];
    $menu = $_SESSION['menu'];
    echo $menu['stylesheets'];
    echo $menu['javascripts'];
    echo $head['JQTABLE'];
    echo $head['THEME'];
    echo $head['T8'];// Übersetzung mit kivi.t8
    echo $head['BOOTSTRAP_CSS'];
    echo $head['BOOTSTRAP_JS'];

    /*****************************************************************************************************************************
    Grundsätze: Content wird via Ajax im Json-Format geholt und an die entsprechenden Container verteilt
                Daten werden ohne Reload einfach via Ajax gespeichert.
                Fürs Holen und Schreiben von Daten befindet sich unter ajax eine gleichnamige Datei mit der Extension ".php"
                Auf das Benutzen der Variable $_SESSION sollte weitestgehend verzichtet werden.
                Statt JS einzusetzen sollte auf die jQuery-Methoden zurückgegriffen werden.
                Url-Parameter werden als hash gefolgt von einem JSON übergeben.
                Vorteil: Browserhistory funktioniert, F5 funktioniert,
            
               
    ******************************************************************************************************************************/

?>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
<script>
  $( document ).ready( function(){


    $( '#headline' ).html( kivi.t8( 'Headline' ) );
  });

</script>

<style>



</style>
</head>

<body>
<?php
    echo $menu['pre_content'];
    echo $menu['start_content'];
?>



  <p id="headline" class="ui-state-highlight ui-corner-all tools" style="margin-top: 20px; padding: 0.6em;"></p>
  <div id="example" style="position:absolute"></div>
  <div class="container">
    <div  class="row">
        <div  class="col-sm-3">
            <h2>Box  1</h2>
            <p id="response"></p>
            <select id="ort">
              foreach()
            </select>
        </div>
        <div  class="col-sm-9">
            <h2>Box  2</h2>
            <input id="inp_txt" type="text" placeholder="Vorname">
        </div>
        <div> <p id="zip_cde">Platzhalter</p></div>
        <div> <input type="text" id="zip_code" placeholder="Postleitzahl"></div>
    </div>
</div>


<script type="text/javascript">

  //wird ausgelöst wenn sich #inp_txt verändert
  $( "#inp_txt" ).change(function(){
    // sendet eine Post-Anfrage an example.php 
    $.ajax({
        url: 'ajax/example.php',
        type: 'POST',
        // sendet den Namen (#inp_txt inhalt) an die example.php
        data:  { action: 'firstnameToGender', data: { 'name': $('#inp_txt').val() } },
        // bei Erfolg wird die Funktion ausgerufen welche von der Response der PHP erbt
        success: function( data ){
          // gibt data aus (Response der PHP ) in der console
          console.info( data );      
          conso
          // filtert gender aus data und ändert den #response Text zum ausgegeben Geschlecht
          $( "#response" ).html( data["gender"] )
        },
        error: function( xhr, status, error ){
          // falls Fehlermeldungen
            alert( xhr, status, error );
        }
    }); // jquery each, key & value append
    

  });

  $('#zip_code').keyup(function(){
    $.ajax({
      url: 'ajax/example.php',
      type: 'POST',
      data: {action: 'getZipCode', data: { 'zipcode': $('#zip_code').val() } },
      success: function( data ){
        $.each(data, function(index, value){
          var opt = document.createElement('option')
          opt.value = index
          opt.innerHTML = JSON.stringify(value["ort"]).replace(new RegExp('"', 'g'),'')
          $("#ort").append(opt)
        })
        console.info(data['ort'])
        console.info(JSON.stringify(data))
      },
      error: function( xhr, status, error ){
        console.info("ERROR", xhr, status, console.error)
      }

    });

  });

  
</script>
<?php echo $menu['end_content']; ?>
</html>
